<div class="codehilite"><pre><span></span><code><span class="c1">-- parse_url</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HOST&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">HOST</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                     </span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;QUERY&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">QUERY</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                               </span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------+</span>

<span class="k">SELECT</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="s1">&#39;http://spark.apache.org/path?query=1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;QUERY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;query&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">parse_url</span><span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">path</span><span class="o">?</span><span class="n">query</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">QUERY</span><span class="p">,</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>
<span class="o">|</span><span class="w">                                                            </span><span class="mi">1</span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------------------------------------------+</span>

<span class="c1">-- try_url_decode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">try_url_decode</span><span class="p">(</span><span class="s1">&#39;https%3A%2F%2Fspark.apache.org&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="n">try_url_decode</span><span class="p">(</span><span class="n">https</span><span class="o">%</span><span class="mi">3</span><span class="n">A</span><span class="o">%</span><span class="mi">2</span><span class="n">F</span><span class="o">%</span><span class="mi">2</span><span class="n">Fspark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>
<span class="o">|</span><span class="w">                          </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apa</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------------------------+</span>

<span class="c1">-- url_decode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">url_decode</span><span class="p">(</span><span class="s1">&#39;https%3A%2F%2Fspark.apache.org&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="n">url_decode</span><span class="p">(</span><span class="n">https</span><span class="o">%</span><span class="mi">3</span><span class="n">A</span><span class="o">%</span><span class="mi">2</span><span class="n">F</span><span class="o">%</span><span class="mi">2</span><span class="n">Fspark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>
<span class="o">|</span><span class="w">                      </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apa</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------+</span>

<span class="c1">-- url_encode</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">url_encode</span><span class="p">(</span><span class="s1">&#39;https://spark.apache.org&#39;</span><span class="p">);</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="n">url_encode</span><span class="p">(</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">spark</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">org</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
<span class="o">|</span><span class="w">                </span><span class="n">https</span><span class="o">%</span><span class="mi">3</span><span class="n">A</span><span class="o">%</span><span class="mi">2</span><span class="n">F</span><span class="o">%</span><span class="mi">2</span><span class="n">Fspa</span><span class="p">...</span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------+</span>
</code></pre></div>